<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HackTheBox - Crypto Challenge "Ancient Cipher" - NYX Cybersecurity</title>
    <meta name="description" content="NYX - Professional Cybersecurity Specialist | Reverse Engineering, DFIR, Penetration Testing, Exploit Development">
    <meta name="keywords" content="cybersecurity, reverse engineering, DFIR, penetration testing, exploit development, malware analysis">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Main stylesheet -->
    <link rel="stylesheet" href="assets/style.css">
</head>
<body>
    <header class="main-header">
        <nav class="navbar">
            <div class="nav-container">
                <a href="index.html" class="nav-brand">
                    <span class="brand-name">NYX</span>
                </a>
                
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="index.html" class="nav-link">Home</a>
                    </li>
                    <li class="nav-item">
                        <a href="blogs.html" class="nav-link">Blogs</a>
                    </li>
                    <li class="nav-item">
                        <a href="writeups.html" class="nav-link">CTF Writeups</a>
                    </li>
                    <li class="nav-item">
                        <a href="services.html" class="nav-link">Services</a>
                    </li>
                    <li class="nav-item">
                        <a href="about.html" class="nav-link">About Me</a>
                    </li>
                    <li class="nav-item">
                        <a href="contact.html" class="nav-link">Contact</a>
                    </li>
                </ul>
                
                <div class="nav-toggle" id="mobile-menu">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </div>
            </div>
        </nav>
    </header>

    
            <main class="content-page">
                <article class="writeup-post">
                    <header class="post-header">
                        <h1>HackTheBox - Crypto Challenge "Ancient Cipher"</h1>
                        <div class="post-meta">
                            <span class="date">2024-08-12</span>
                            <span class="category">Crypto</span>
                            <div class="tags">
                                <span class="tag">[cryptography, substitution-cipher, python, hackthebox]</span>
                            </div>
                        </div>
                    </header>
                    <div class="post-content">
                        <h1 id="hackthebox-ancient-cipher-writeup">HackTheBox - Ancient Cipher Writeup</h1>
<div class="info-box">**Challenge Info:** This writeup covers a medium-difficulty cryptography challenge from HackTheBox involving classical cipher techniques and frequency analysis.</div>

<h2 id="challenge-description">Challenge Description</h2>
<p>This crypto challenge from HackTheBox presents us with an ancient cipher that needs to be decoded. The challenge provides an encrypted message and hints that it uses a classical substitution cipher technique.</p>
<p><strong>Challenge Details:</strong><br />
- Difficulty: Medium<br />
- Category: Cryptography<br />
- Points: 300</p>
<h2 id="initial-analysis">Initial Analysis</h2>
<p>Upon downloading the challenge files, we receive:<br />
- <code>encrypted.txt</code>: Contains the encrypted message<br />
- <code>hint.txt</code>: Provides context about the cipher type</p>
<p>The encrypted text appears to be:</p>
<pre><code>WKLV LV D VLPSOH VXEVWLWXWLRQ FLSKHU WKDW XVHV D FDVDU FLSKHU ZLWK D VKLIW RI WKUHH
</code></pre>
<div class="warning-box">**Observation:** The text maintains word boundaries and spacing, which suggests it's likely a simple substitution cipher rather than a complex polyalphabetic cipher.</div>

<h2 id="frequency-analysis">Frequency Analysis</h2>
<p>Let's start by performing frequency analysis on the encrypted text:</p>
<pre><code class="language-python">def frequency_analysis(text):
    &quot;&quot;&quot;Perform frequency analysis on encrypted text&quot;&quot;&quot;
    text = text.upper().replace(' ', '')
    freq_dict = {}

    for char in text:
        if char.isalpha():
            freq_dict[char] = freq_dict.get(char, 0) + 1

    # Sort by frequency
    sorted_freq = sorted(freq_dict.items(), key=lambda x: x[1], reverse=True)

    print(&quot;Character Frequency Analysis:&quot;)
    for char, count in sorted_freq:
        percentage = (count / len([c for c in text if c.isalpha()])) * 100
        print(f&quot;{char}: {count} ({percentage:.1f}%)&quot;)

encrypted = &quot;WKLV LV D VLPSOH VXEVWLWXWLRQ FLSKHU WKDW XVHV D FDVDU FLSKHU ZLWK D VKLIW RI WKUHH&quot;
frequency_analysis(encrypted)
</code></pre>
<p>Output:</p>
<pre><code>Character Frequency Analysis:
L: 6 (12.8%)
V: 5 (10.6%)
K: 4 (8.5%)
H: 4 (8.5%)
</code></pre>
<h2 id="pattern-recognition">Pattern Recognition</h2>
<p>Looking at the structure and frequency distribution, this appears to be a Caesar cipher. Let's try different shift values:</p>
<div class="success-box">**Key Insight:** Caesar ciphers are monoalphabetic substitution ciphers where each letter is shifted by a fixed number of positions in the alphabet.</div>

<pre><code class="language-python">def caesar_decrypt(text, shift):
    &quot;&quot;&quot;Decrypt Caesar cipher with given shift&quot;&quot;&quot;
    result = &quot;&quot;

    for char in text:
        if char.isalpha():
            # Handle uppercase letters
            if char.isupper():
                result += chr((ord(char) - ord('A') - shift) % 26 + ord('A'))
            # Handle lowercase letters
            else:
                result += chr((ord(char) - ord('a') - shift) % 26 + ord('a'))
        else:
            result += char

    return result

# Test different shift values
encrypted = &quot;WKLV LV D VLPSOH VXEVWLWXWLRQ FLSKHU WKDW XVHV D FDVDU FLSKHU ZLWK D VKLIW RI WKUHH&quot;

for shift in range(26):
    decrypted = caesar_decrypt(encrypted, shift)
    print(f&quot;Shift {shift}: {decrypted}&quot;)
</code></pre>
<h2 id="solution-discovery">Solution Discovery</h2>
<p>After testing various shifts, we find that a shift of <strong>3</strong> produces readable English text:</p>
<div class="success-box">**Solution Found:** With a shift of 3, the decrypted message reads: "THIS IS A SIMPLE SUBSTITUTION CIPHER THAT USES A CAESAR CIPHER WITH A SHIFT OF THREE"</div>

<h2 id="automated-solution-script">Automated Solution Script</h2>
<p>Here's the complete solution script:</p>
<pre><code class="language-python">#!/usr/bin/env python3

def caesar_decrypt(text, shift):
    &quot;&quot;&quot;Decrypt Caesar cipher with given shift&quot;&quot;&quot;
    result = &quot;&quot;

    for char in text:
        if char.isalpha():
            if char.isupper():
                result += chr((ord(char) - ord('A') - shift) % 26 + ord('A'))
            else:
                result += chr((ord(char) - ord('a') - shift) % 26 + ord('a'))
        else:
            result += char

    return result

def find_caesar_key(encrypted_text):
    &quot;&quot;&quot;Find the most likely Caesar cipher key by testing all possibilities&quot;&quot;&quot;
    common_words = ['THE', 'AND', 'IS', 'A', 'TO', 'OF', 'IN', 'IT', 'YOU', 'THAT']

    best_score = 0
    best_shift = 0

    for shift in range(26):
        decrypted = caesar_decrypt(encrypted_text, shift).upper()
        score = sum(1 for word in common_words if word in decrypted)

        if score &gt; best_score:
            best_score = score
            best_shift = shift

    return best_shift

# Main execution
if __name__ == &quot;__main__&quot;:
    encrypted = &quot;WKLV LV D VLPSOH VXEVWLWXWLRQ FLSKHU WKDW XVHV D FDVDU FLSKHU ZLWK D VKLIW RI WKUHH&quot;

    # Find the key automatically
    key = find_caesar_key(encrypted)

    # Decrypt with the found key
    decrypted = caesar_decrypt(encrypted, key)

    print(f&quot;Detected shift: {key}&quot;)
    print(f&quot;Decrypted message: {decrypted}&quot;)
    print(f&quot;Flag format: HTB{{{decrypted.replace(' ', '_').lower()}}}&quot;)
</code></pre>
<h2 id="key-lessons-learned">Key Lessons Learned</h2>
<div class="note-box">**Learning Outcomes:**
1. **Frequency Analysis:** Always start with frequency analysis for substitution ciphers
2. **Pattern Recognition:** Look for common patterns in encrypted text
3. **Automation:** Create scripts to test multiple possibilities systematically
4. **Validation:** Use common English words to validate potential solutions</div>

<h2 id="flag-submission">Flag Submission</h2>
<p>The final flag for submission would be:</p>
<pre><code>HTB{this_is_a_simple_substitution_cipher_that_uses_a_caesar_cipher_with_a_shift_of_three}
</code></pre>
<div class="danger-box">**Security Note:** While Caesar ciphers were used historically, they are extremely weak by modern standards and should never be used for real-world cryptographic applications.</div>
                    </div>
                </article>
                <nav class="post-navigation">
                    <a href="writeups.html" class="back-link">‚Üê Back to Writeups</a>
                </nav>
            </main>
            

    <footer class="main-footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>NYX</h3>
                    <p>Professional Cybersecurity Specialist</p>
                    <div class="social-links">
                        <a href="#" aria-label="GitHub"><i class="fab fa-github"></i></a>
                        <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a>
                        <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="mailto:contact@nyx-cyber.com" aria-label="Email"><i class="fas fa-envelope"></i></a>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h4>Services</h4>
                    <ul>
                        <li><a href="services.html">Penetration Testing</a></li>
                        <li><a href="services.html">Incident Response</a></li>
                        <li><a href="services.html">Malware Analysis</a></li>
                        <li><a href="services.html">Reverse Engineering</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="blogs.html">Blog Posts</a></li>
                        <li><a href="writeups.html">CTF Writeups</a></li>
                        <li><a href="about.html">About</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2024 NYX Cybersecurity. All rights reserved.</p>
            </div>
        </div>
    </footer>
</body>
</html>
