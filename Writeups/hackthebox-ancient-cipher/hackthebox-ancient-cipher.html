<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HackTheBox - Crypto Challenge "Ancient Cipher" - NYX Cybersecurity</title>
    <meta name="description" content="Geetansh Aditya - Professional Cybersecurity Specialist | Reverse Engineering, DFIR, Penetration Testing, Exploit Development">
    <meta name="keywords" content="cybersecurity, reverse engineering, DFIR, penetration testing, exploit development, malware analysis">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Main stylesheet -->
    <link rel="stylesheet" href="../../assets/style.css">
</head>
<body>
    <header class="main-header">
        <nav class="navbar">
            <div class="nav-container">
                <a href="../../index.html" class="nav-brand">
                    <span class="brand-name">Geetansh Aditya</span>
                </a>
                
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="../../index.html" class="nav-link">Home</a>
                    </li>
                    <li class="nav-item">
                        <a href="../../blogs.html" class="nav-link">Blogs</a>
                    </li>
                    <li class="nav-item">
                        <a href="../../writeups.html" class="nav-link">CTF Writeups</a>
                    </li>
                    <li class="nav-item">
                        <a href="../../services.html" class="nav-link">Services</a>
                    </li>
                    <li class="nav-item">
                        <a href="../../about.html" class="nav-link">About Me</a>
                    </li>
                    <li class="nav-item">
                        <a href="../../contact.html" class="nav-link">Contact</a>
                    </li>
                </ul>
                
                <div class="nav-toggle" id="mobile-menu">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </div>
            </div>
        </nav>
    </header>

    
            <main class="content-page">
                <article class="writeup-post">
                    <header class="post-header">
                        <h1>HackTheBox - Crypto Challenge "Ancient Cipher"</h1>
                        <div class="post-meta">
                            <span class="date">2024-08-12</span>
                            <span class="category">Crypto</span>
                            <div class="tags">
                                <span class="tag">[cryptography, substitution-cipher, python, hackthebox]</span>
                            </div>
                        </div>
                    </header>
                    <div class="post-content">
                        <h1 id="hackthebox-ancient-cipher-writeup">HackTheBox - Ancient Cipher Writeup</h1>
<div class="info-box">**Challenge Info:** This writeup covers a medium-difficulty cryptography challenge from HackTheBox involving classical cipher techniques and frequency analysis.</div>

<h2 id="challenge-description">Challenge Description</h2>
<p>This crypto challenge from HackTheBox presents us with an ancient cipher that needs to be decoded. The challenge provides an encrypted message and hints that it uses a classical substitution cipher technique.</p>
<p><strong>Challenge Details:</strong><br />
- Difficulty: Medium<br />
- Category: Cryptography<br />
- Points: 300</p>
<h2 id="initial-analysis">Initial Analysis</h2>
<p>Upon downloading the challenge files, we receive:<br />
- <code>encrypted.txt</code>: Contains the encrypted message<br />
- <code>hint.txt</code>: Provides context about the cipher type</p>
<p>The encrypted text appears to be:</p>
<div class="highlight"><pre><span></span><code>WKLV LV D VLPSOH VXEVWLWXWLRQ FLSKHU WKDW XVHV D FDVDU FLSKHU ZLWK D VKLIW RI WKUHH
</code></pre></div>

<div class="warning-box">**Observation:** The text maintains word boundaries and spacing, which suggests it's likely a simple substitution cipher rather than a complex polyalphabetic cipher.</div>

<h2 id="frequency-analysis">Frequency Analysis</h2>
<p>Let's start by performing frequency analysis on the encrypted text:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">frequency_analysis</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform frequency analysis on encrypted text&quot;&quot;&quot;</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">freq_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">char</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
            <span class="n">freq_dict</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="o">=</span> <span class="n">freq_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="c1"># Sort by frequency</span>
    <span class="n">sorted_freq</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">freq_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Character Frequency Analysis:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">char</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">sorted_freq</span><span class="p">:</span>
        <span class="n">percentage</span> <span class="o">=</span> <span class="p">(</span><span class="n">count</span> <span class="o">/</span> <span class="nb">len</span><span class="p">([</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">text</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()]))</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">percentage</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

<span class="n">encrypted</span> <span class="o">=</span> <span class="s2">&quot;WKLV LV D VLPSOH VXEVWLWXWLRQ FLSKHU WKDW XVHV D FDVDU FLSKHU ZLWK D VKLIW RI WKUHH&quot;</span>
<span class="n">frequency_analysis</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)</span>
</code></pre></div>

<p>Output:</p>
<div class="highlight"><pre><span></span><code>Character Frequency Analysis:
L: 6 (12.8%)
V: 5 (10.6%)
K: 4 (8.5%)
H: 4 (8.5%)
</code></pre></div>

<h2 id="pattern-recognition">Pattern Recognition</h2>
<p>Looking at the structure and frequency distribution, this appears to be a Caesar cipher. Let's try different shift values:</p>
<div class="success-box">**Key Insight:** Caesar ciphers are monoalphabetic substitution ciphers where each letter is shifted by a fixed number of positions in the alphabet.</div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">caesar_decrypt</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">shift</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decrypt Caesar cipher with given shift&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">char</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
            <span class="c1"># Handle uppercase letters</span>
            <span class="k">if</span> <span class="n">char</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">((</span><span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="n">shift</span><span class="p">)</span> <span class="o">%</span> <span class="mi">26</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">))</span>
            <span class="c1"># Handle lowercase letters</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">((</span><span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="n">shift</span><span class="p">)</span> <span class="o">%</span> <span class="mi">26</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="n">char</span>

    <span class="k">return</span> <span class="n">result</span>

<span class="c1"># Test different shift values</span>
<span class="n">encrypted</span> <span class="o">=</span> <span class="s2">&quot;WKLV LV D VLPSOH VXEVWLWXWLRQ FLSKHU WKDW XVHV D FDVDU FLSKHU ZLWK D VKLIW RI WKUHH&quot;</span>

<span class="k">for</span> <span class="n">shift</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">26</span><span class="p">):</span>
    <span class="n">decrypted</span> <span class="o">=</span> <span class="n">caesar_decrypt</span><span class="p">(</span><span class="n">encrypted</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shift </span><span class="si">{</span><span class="n">shift</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">decrypted</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h2 id="solution-discovery">Solution Discovery</h2>
<p>After testing various shifts, we find that a shift of <strong>3</strong> produces readable English text:</p>
<div class="success-box">**Solution Found:** With a shift of 3, the decrypted message reads: "THIS IS A SIMPLE SUBSTITUTION CIPHER THAT USES A CAESAR CIPHER WITH A SHIFT OF THREE"</div>

<h2 id="automated-solution-script">Automated Solution Script</h2>
<p>Here's the complete solution script:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>

<span class="k">def</span><span class="w"> </span><span class="nf">caesar_decrypt</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">shift</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decrypt Caesar cipher with given shift&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">char</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">char</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">((</span><span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="n">shift</span><span class="p">)</span> <span class="o">%</span> <span class="mi">26</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">((</span><span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="n">shift</span><span class="p">)</span> <span class="o">%</span> <span class="mi">26</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="n">char</span>

    <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span><span class="w"> </span><span class="nf">find_caesar_key</span><span class="p">(</span><span class="n">encrypted_text</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the most likely Caesar cipher key by testing all possibilities&quot;&quot;&quot;</span>
    <span class="n">common_words</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;THE&#39;</span><span class="p">,</span> <span class="s1">&#39;AND&#39;</span><span class="p">,</span> <span class="s1">&#39;IS&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;TO&#39;</span><span class="p">,</span> <span class="s1">&#39;OF&#39;</span><span class="p">,</span> <span class="s1">&#39;IN&#39;</span><span class="p">,</span> <span class="s1">&#39;IT&#39;</span><span class="p">,</span> <span class="s1">&#39;YOU&#39;</span><span class="p">,</span> <span class="s1">&#39;THAT&#39;</span><span class="p">]</span>

    <span class="n">best_score</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">best_shift</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">shift</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">26</span><span class="p">):</span>
        <span class="n">decrypted</span> <span class="o">=</span> <span class="n">caesar_decrypt</span><span class="p">(</span><span class="n">encrypted_text</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">score</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">common_words</span> <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">decrypted</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="n">best_score</span><span class="p">:</span>
            <span class="n">best_score</span> <span class="o">=</span> <span class="n">score</span>
            <span class="n">best_shift</span> <span class="o">=</span> <span class="n">shift</span>

    <span class="k">return</span> <span class="n">best_shift</span>

<span class="c1"># Main execution</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">encrypted</span> <span class="o">=</span> <span class="s2">&quot;WKLV LV D VLPSOH VXEVWLWXWLRQ FLSKHU WKDW XVHV D FDVDU FLSKHU ZLWK D VKLIW RI WKUHH&quot;</span>

    <span class="c1"># Find the key automatically</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">find_caesar_key</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)</span>

    <span class="c1"># Decrypt with the found key</span>
    <span class="n">decrypted</span> <span class="o">=</span> <span class="n">caesar_decrypt</span><span class="p">(</span><span class="n">encrypted</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Detected shift: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decrypted message: </span><span class="si">{</span><span class="n">decrypted</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Flag format: HTB</span><span class="se">{{</span><span class="s2">decrypted.replace(&#39; &#39;, &#39;_&#39;).lower()</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h2 id="key-lessons-learned">Key Lessons Learned</h2>
<div class="note-box">**Learning Outcomes:**
1. **Frequency Analysis:** Always start with frequency analysis for substitution ciphers
2. **Pattern Recognition:** Look for common patterns in encrypted text
3. **Automation:** Create scripts to test multiple possibilities systematically
4. **Validation:** Use common English words to validate potential solutions</div>

<h2 id="flag-submission">Flag Submission</h2>
<p>The final flag for submission would be:</p>
<div class="highlight"><pre><span></span><code><span class="nx">HTB</span><span class="p">{</span><span class="nx">this_is_a_simple_substitution_cipher_that_uses_a_caesar_cipher_with_a_shift_of_three</span><span class="p">}</span>
</code></pre></div>

<div class="danger-box">**Security Note:** While Caesar ciphers were used historically, they are extremely weak by modern standards and should never be used for real-world cryptographic applications.</div>
                    </div>
                </article>
                <nav class="post-navigation">
                    <a href="../../writeups.html" class="back-link">‚Üê Back to Writeups</a>
                </nav>
            </main>
            

    <footer class="main-footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Geetansh Aditya</h3>
                    <p>Professional Cybersecurity Specialist</p>
                    <div class="social-links">
                        <a href="https://github.com/RootUser-GeetanshAditya/" aria-label="GitHub" target="_blank"><i class="fab fa-github"></i></a>
                        <a href="https://www.linkedin.com/in/geetansh-aditya/" aria-label="LinkedIn" target="_blank"><i class="fab fa-linkedin"></i></a>
                        <a href="https://x.com/Geetansh_Aditya" aria-label="Twitter" target="_blank"><i class="fab fa-twitter"></i></a>
                        <a href="mailto:geetanshaditya2005@gmail.com" aria-label="Email" target="_blank"><i class="fas fa-envelope"></i></a>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h4>Services</h4>
                    <ul>
                        <li><a href="../../services.html">Penetration Testing</a></li>
                        <li><a href="../../services.html">Incident Response</a></li>
                        <li><a href="../../services.html">Malware Analysis</a></li>
                        <li><a href="../../services.html">Reverse Engineering</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="../../blogs.html">Blog Posts</a></li>
                        <li><a href="../../writeups.html">CTF Writeups</a></li>
                        <li><a href="../../about.html">About</a></li>
                        <li><a href="../../contact.html">Contact</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 Geetansh Aditya. All rights reserved.</p>
            </div>
        </div>
    </footer>
</body>
</html>
